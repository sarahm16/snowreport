{"version":3,"file":"msal-react.cjs.production.min.js","sources":["../src/MsalContext.ts","../src/utils/utilities.ts","../src/hooks/useMsal.ts","../src/hooks/useAccount.ts","../src/hooks/useIsAuthenticated.ts","../src/hooks/useMsalAuthentication.ts","../src/components/AuthenticatedTemplate.tsx","../src/components/MsalAuthenticationTemplate.tsx","../src/MsalProvider.tsx","../src/packageMetadata.ts","../src/components/UnauthenticatedTemplate.tsx","../src/components/withMsal.tsx"],"sourcesContent":["/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\nimport * as React from \"react\";\r\nimport { IPublicClientApplication, stubbedPublicClientApplication, Logger, InteractionStatus, AccountInfo } from \"@azure/msal-browser\";\r\n\r\nexport interface IMsalContext {\r\n    instance: IPublicClientApplication;\r\n    inProgress: InteractionStatus;\r\n    accounts: AccountInfo[];\r\n    logger: Logger;\r\n}\r\n\r\n/*\r\n * Stubbed context implementation\r\n * Only used when there is no provider, which is an unsupported scenario\r\n */\r\nconst defaultMsalContext: IMsalContext = {\r\n    instance: stubbedPublicClientApplication,\r\n    inProgress: InteractionStatus.None,\r\n    accounts: [],\r\n    logger: new Logger({})\r\n};\r\n\r\nexport const MsalContext = React.createContext<IMsalContext>(\r\n    defaultMsalContext\r\n);\r\nexport const MsalConsumer = MsalContext.Consumer;\r\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\nimport { AccountIdentifiers } from \"../types/AccountIdentifiers\";\r\n\r\ntype FaaCFunction = <T>(args: T) => React.ReactNode;\r\n\r\nexport function getChildrenOrFunction<T>(\r\n    children: React.ReactNode | FaaCFunction,\r\n    args: T\r\n): React.ReactNode {\r\n    if (typeof children === \"function\") {\r\n        return children(args);\r\n    }\r\n    return children;\r\n}\r\n\r\n/*\r\n * Utility types\r\n * Reference: https://github.com/piotrwitek/utility-types\r\n */\r\ntype SetDifference<A, B> = A extends B ? never : A;\r\ntype SetComplement<A, A1 extends A> = SetDifference<A, A1>;\r\nexport type Subtract<T extends T1, T1 extends object> = Pick<T,SetComplement<keyof T, keyof T1>>;\r\n\r\n/**\r\n * Helper function to determine whether 2 arrays are equal\r\n * Used to avoid unnecessary state updates\r\n * @param arrayA \r\n * @param arrayB \r\n */\r\nexport function accountArraysAreEqual(arrayA: Array<AccountIdentifiers>, arrayB: Array<AccountIdentifiers>): boolean {\r\n    if (arrayA.length !== arrayB.length) {\r\n        return false;\r\n    }\r\n\r\n    const comparisonArray = [...arrayB];\r\n\r\n    return arrayA.every((elementA) => {\r\n        const elementB = comparisonArray.shift();\r\n        if (!elementA || !elementB) {\r\n            return false;\r\n        }\r\n\r\n        return (elementA.homeAccountId === elementB.homeAccountId) && \r\n               (elementA.localAccountId === elementB.localAccountId) &&\r\n               (elementA.username === elementB.username);\r\n    });\r\n}\r\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\nimport { useContext } from \"react\";\r\nimport { IMsalContext, MsalContext } from \"../MsalContext\";\r\n\r\n/**\r\n * Returns Msal Context values\r\n */\r\nexport const useMsal = (): IMsalContext => useContext(MsalContext);\r\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { AccountInfo, IPublicClientApplication, InteractionStatus, AccountEntity } from \"@azure/msal-browser\";\r\nimport { useMsal } from \"./useMsal\";\r\nimport { AccountIdentifiers } from \"../types/AccountIdentifiers\";\r\n\r\nfunction getAccount(instance: IPublicClientApplication, accountIdentifiers: AccountIdentifiers): AccountInfo | null {\r\n    const allAccounts = instance.getAllAccounts();\r\n    if (allAccounts.length > 0 && (accountIdentifiers.homeAccountId || accountIdentifiers.localAccountId || accountIdentifiers.username)) {\r\n        const matchedAccounts = allAccounts.filter(accountObj => {\r\n            if (accountIdentifiers.username && accountIdentifiers.username.toLowerCase() !== accountObj.username.toLowerCase()) {\r\n                return false;\r\n            }\r\n            if (accountIdentifiers.homeAccountId && accountIdentifiers.homeAccountId.toLowerCase() !== accountObj.homeAccountId.toLowerCase()) {\r\n                return false;\r\n            }\r\n            if (accountIdentifiers.localAccountId && accountIdentifiers.localAccountId.toLowerCase() !== accountObj.localAccountId.toLowerCase()) {\r\n                return false;\r\n            }\r\n\r\n            return true;\r\n        });\r\n\r\n        return matchedAccounts[0] || null;\r\n    } else {\r\n        return null;\r\n    }\r\n}\r\n\r\n/**\r\n * Given 1 or more accountIdentifiers, returns the Account object if the user is signed-in\r\n * @param accountIdentifiers \r\n */\r\nexport function useAccount(accountIdentifiers: AccountIdentifiers): AccountInfo | null {\r\n    const { instance, inProgress } = useMsal();\r\n\r\n    const initialStateValue = inProgress === InteractionStatus.Startup ? null : getAccount(instance, accountIdentifiers);\r\n    const [account, setAccount] = useState<AccountInfo|null>(initialStateValue);\r\n\r\n    useEffect(() => {\r\n        const currentAccount = getAccount(instance, accountIdentifiers);\r\n        if (!AccountEntity.accountInfoIsEqual(account, currentAccount, true)) {\r\n            setAccount(currentAccount);\r\n        }\r\n    }, [inProgress, accountIdentifiers, instance, account]);\r\n\r\n    return account;\r\n}\r\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useMsal } from \"./useMsal\";\r\nimport { AccountIdentifiers } from \"../types/AccountIdentifiers\";\r\nimport { useAccount } from \"./useAccount\";\r\nimport { AccountInfo, InteractionStatus } from \"@azure/msal-browser\";\r\n\r\nfunction isAuthenticated(allAccounts: AccountIdentifiers[], account: AccountInfo | null, matchAccount?: AccountIdentifiers): boolean {\r\n    if(matchAccount && (matchAccount.username || matchAccount.homeAccountId || matchAccount.localAccountId)) {\r\n        return !!account;\r\n    }   \r\n\r\n    return allAccounts.length > 0;\r\n}\r\n\r\n/**\r\n * Returns whether or not a user is currently signed-in. Optionally provide 1 or more accountIdentifiers to determine if a specific user is signed-in\r\n * @param matchAccount \r\n */\r\nexport function useIsAuthenticated(matchAccount?: AccountIdentifiers): boolean {\r\n    const { accounts: allAccounts, inProgress } = useMsal();\r\n    const account = useAccount(matchAccount || {});\r\n\r\n    const initialStateValue = inProgress === InteractionStatus.Startup ? false : isAuthenticated(allAccounts, account, matchAccount);\r\n    const [hasAuthenticated, setHasAuthenticated] = useState<boolean>(initialStateValue);\r\n\r\n    useEffect(() => {\r\n        setHasAuthenticated(isAuthenticated(allAccounts, account, matchAccount));\r\n    }, [allAccounts, account, matchAccount]);\r\n\r\n    return hasAuthenticated;\r\n}\r\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\nimport { useCallback, useEffect, useState } from \"react\";\r\nimport { PopupRequest, RedirectRequest, SsoSilentRequest, InteractionType, AuthenticationResult, AuthError, EventMessage, EventType, InteractionStatus } from \"@azure/msal-browser\";\r\nimport { useIsAuthenticated } from \"./useIsAuthenticated\";\r\nimport { AccountIdentifiers } from \"../types/AccountIdentifiers\";\r\nimport { useMsal } from \"./useMsal\";\r\n\r\nexport type MsalAuthenticationResult = {\r\n    login: Function; \r\n    result: AuthenticationResult|null;\r\n    error: AuthError|null;\r\n};\r\n\r\n/**\r\n * Invokes a login call if a user is not currently signed-in. Failed logins can be retried using the login callback returned.\r\n * Optionally provide a request object to be used in the login call.\r\n * Optionally provide a specific user that should be logged in.\r\n * @param interactionType \r\n * @param authenticationRequest \r\n * @param accountIdentifiers \r\n */\r\nexport function useMsalAuthentication(\r\n    interactionType: InteractionType, \r\n    authenticationRequest?: PopupRequest|RedirectRequest|SsoSilentRequest, \r\n    accountIdentifiers?: AccountIdentifiers\r\n): MsalAuthenticationResult {\r\n    const { instance, inProgress, logger } = useMsal();\r\n    const isAuthenticated = useIsAuthenticated(accountIdentifiers);\r\n    const [[result, error], setResponse] = useState<[AuthenticationResult|null, AuthError|null]>([null, null]);\r\n    const [hasBeenCalled, setHasBeenCalled] = useState<boolean>(false);\r\n\r\n    const login = useCallback(async (callbackInteractionType?: InteractionType, callbackRequest?: PopupRequest|RedirectRequest|SsoSilentRequest): Promise<AuthenticationResult|null> => {\r\n        const loginType = callbackInteractionType || interactionType;\r\n        const loginRequest = callbackRequest || authenticationRequest;\r\n        switch (loginType) {\r\n            case InteractionType.Popup:\r\n                logger.verbose(\"useMsalAuthentication - Calling loginPopup\");\r\n                return instance.loginPopup(loginRequest as PopupRequest);\r\n            case InteractionType.Redirect:\r\n                // This promise is not expected to resolve due to full frame redirect\r\n                logger.verbose(\"useMsalAuthentication - Calling loginRedirect\");\r\n                return instance.loginRedirect(loginRequest as RedirectRequest).then(null);\r\n            case InteractionType.Silent:\r\n                logger.verbose(\"useMsalAuthentication - Calling ssoSilent\");\r\n                return instance.ssoSilent(loginRequest as SsoSilentRequest);\r\n            default:\r\n                throw \"Invalid interaction type provided.\";\r\n        }\r\n    }, [instance, interactionType, authenticationRequest, logger]);\r\n\r\n    useEffect(() => {\r\n        const callbackId = instance.addEventCallback((message: EventMessage) => {\r\n            switch(message.eventType) {\r\n                case EventType.LOGIN_SUCCESS:\r\n                case EventType.SSO_SILENT_SUCCESS:\r\n                    if (message.payload) {\r\n                        setResponse([message.payload as AuthenticationResult, null]);\r\n                    }\r\n                    break;\r\n                case EventType.LOGIN_FAILURE:\r\n                case EventType.SSO_SILENT_FAILURE:\r\n                    if (message.error) {\r\n                        setResponse([null, message.error as AuthError]);\r\n                    }\r\n                    break;\r\n            }\r\n        });\r\n        logger.verbose(`useMsalAuthentication - Registered event callback with id: ${callbackId}`);\r\n\r\n        return () => {\r\n            if (callbackId) {\r\n                logger.verbose(`useMsalAuthentication - Removing event callback ${callbackId}`);\r\n                instance.removeEventCallback(callbackId);\r\n            }\r\n        };\r\n    }, [instance, logger]);\r\n\r\n    useEffect(() => {\r\n        if (!hasBeenCalled && !error && !isAuthenticated && inProgress === InteractionStatus.None) {\r\n            logger.info(\"useMsalAuthentication - No user is authenticated, attempting to login\");\r\n            // Ensure login is only called one time from within this hook, any subsequent login attempts should use the callback returned\r\n            setHasBeenCalled(true);\r\n            login().catch(() => {\r\n                // Errors are handled by the event handler above\r\n                return;\r\n            });\r\n        }\r\n    }, [isAuthenticated, inProgress, error, hasBeenCalled, login, logger]);\r\n\r\n    return { login, result, error };\r\n}\r\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\nimport React, { PropsWithChildren, useMemo } from \"react\";\r\nimport { AccountIdentifiers } from \"../types/AccountIdentifiers\";\r\nimport { getChildrenOrFunction } from \"../utils/utilities\";\r\nimport { useMsal } from \"../hooks/useMsal\";\r\nimport { useIsAuthenticated } from \"../hooks/useIsAuthenticated\";\r\nimport { InteractionStatus } from \"@azure/msal-browser\";\r\n\r\nexport type AuthenticatedTemplateProps = PropsWithChildren<AccountIdentifiers>;\r\n\r\n/**\r\n * Renders child components if user is authenticated\r\n * @param props \r\n */\r\nexport function AuthenticatedTemplate({ username, homeAccountId, localAccountId, children }: AuthenticatedTemplateProps): React.ReactElement|null {\r\n    const context = useMsal();\r\n    const accountIdentifier: AccountIdentifiers = useMemo(() => {\r\n        return {\r\n            username,\r\n            homeAccountId,\r\n            localAccountId\r\n        };\r\n    }, [username, homeAccountId, localAccountId]);\r\n    const isAuthenticated = useIsAuthenticated(accountIdentifier);\r\n\r\n    if (isAuthenticated && context.inProgress !== InteractionStatus.Startup) {\r\n        return (\r\n            <React.Fragment>\r\n                {getChildrenOrFunction(children, context)}\r\n            </React.Fragment>\r\n        );\r\n    }\r\n    return null;\r\n}\r\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\nimport React, { PropsWithChildren, useMemo } from \"react\";\r\nimport { AccountIdentifiers } from \"../types/AccountIdentifiers\";\r\nimport { getChildrenOrFunction } from \"../utils/utilities\";\r\nimport { useMsal } from \"../hooks/useMsal\";\r\nimport { MsalAuthenticationResult, useMsalAuthentication } from \"../hooks/useMsalAuthentication\";\r\nimport { useIsAuthenticated } from \"../hooks/useIsAuthenticated\";\r\nimport { InteractionType, PopupRequest, RedirectRequest, SsoSilentRequest, InteractionStatus } from \"@azure/msal-browser\";\r\nimport { IMsalContext } from \"../MsalContext\";\r\n\r\nexport type MsalAuthenticationProps = PropsWithChildren<AccountIdentifiers & {\r\n    interactionType: InteractionType;\r\n    authenticationRequest?: PopupRequest|RedirectRequest|SsoSilentRequest;\r\n    loadingComponent?: React.ElementType<IMsalContext>;\r\n    errorComponent?: React.ElementType<MsalAuthenticationResult>;\r\n}>;\r\n\r\n/**\r\n * Attempts to authenticate user if not already authenticated, then renders child components\r\n * @param props\r\n */\r\nexport function MsalAuthenticationTemplate({ \r\n    interactionType, \r\n    username, \r\n    homeAccountId, \r\n    localAccountId,\r\n    authenticationRequest, \r\n    loadingComponent: LoadingComponent,\r\n    errorComponent: ErrorComponent,\r\n    children \r\n}: MsalAuthenticationProps): React.ReactElement|null {\r\n    const accountIdentifier: AccountIdentifiers = useMemo(() => {\r\n        return {\r\n            username,\r\n            homeAccountId,\r\n            localAccountId\r\n        };\r\n    }, [username, homeAccountId, localAccountId]);\r\n    const context = useMsal();\r\n    const msalAuthResult = useMsalAuthentication(interactionType, authenticationRequest, accountIdentifier);\r\n    const isAuthenticated = useIsAuthenticated(accountIdentifier);\r\n\r\n    if (msalAuthResult.error && context.inProgress === InteractionStatus.None) {\r\n        if (!!ErrorComponent) {\r\n            return <ErrorComponent {...msalAuthResult} />;\r\n        }\r\n\r\n        throw msalAuthResult.error;\r\n    }\r\n    \r\n    if (isAuthenticated) {\r\n        return (\r\n            <React.Fragment>\r\n                {getChildrenOrFunction(children, msalAuthResult)}\r\n            </React.Fragment>\r\n        );\r\n    } \r\n    \r\n    if (!!LoadingComponent && context.inProgress !== InteractionStatus.None) {\r\n        return <LoadingComponent {...context} />;\r\n    }\r\n\r\n    return null;\r\n}\r\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\nimport React, { useState, useEffect, useRef, PropsWithChildren, useMemo } from \"react\";\r\nimport {\r\n    IPublicClientApplication,\r\n    EventType,\r\n    EventMessage,\r\n    EventMessageUtils,\r\n    InteractionStatus,\r\n    Logger,\r\n    WrapperSKU,\r\n    AccountInfo\r\n} from \"@azure/msal-browser\";\r\nimport { MsalContext, IMsalContext } from \"./MsalContext\";\r\nimport { accountArraysAreEqual } from \"./utils/utilities\";\r\nimport { name as SKU, version } from \"./packageMetadata\";\r\n\r\nexport type MsalProviderProps = PropsWithChildren<{\r\n    instance: IPublicClientApplication;\r\n}>;\r\n\r\nexport function MsalProvider({instance, children}: MsalProviderProps): React.ReactElement {\r\n    useEffect(() => {\r\n        instance.initializeWrapperLibrary(WrapperSKU.React, version);\r\n    }, [instance]);\r\n    // Create a logger instance for msal-react with the same options as PublicClientApplication\r\n    const logger: Logger = useMemo(() => {\r\n        return instance.getLogger().clone(SKU, version);\r\n    }, [instance]);\r\n\r\n    // State hook to store accounts\r\n    const [accounts, setAccounts] = useState<AccountInfo[]>([]);\r\n    // State hook to store in progress value\r\n    const [inProgress, setInProgress] = useState<InteractionStatus>(InteractionStatus.Startup);\r\n    // Mutable object used in the event callback\r\n    const inProgressRef = useRef(inProgress);\r\n    \r\n    useEffect(() => {\r\n        const callbackId = instance.addEventCallback((message: EventMessage) => {\r\n            switch (message.eventType) {\r\n                case EventType.ACCOUNT_ADDED:\r\n                case EventType.ACCOUNT_REMOVED:\r\n                case EventType.LOGIN_SUCCESS:\r\n                case EventType.SSO_SILENT_SUCCESS:\r\n                case EventType.HANDLE_REDIRECT_END:\r\n                case EventType.LOGIN_FAILURE:\r\n                case EventType.SSO_SILENT_FAILURE:\r\n                case EventType.LOGOUT_END:\r\n                case EventType.ACQUIRE_TOKEN_SUCCESS:\r\n                case EventType.ACQUIRE_TOKEN_FAILURE:\r\n                    const currentAccounts = instance.getAllAccounts();\r\n                    if (!accountArraysAreEqual(currentAccounts, accounts)) {\r\n                        logger.info(\"MsalProvider - updating account state\");\r\n                        setAccounts(currentAccounts);\r\n                    } else {\r\n                        logger.info(\"MsalProvider - no account changes\");\r\n                    }\r\n                    break;\r\n            }\r\n        });\r\n        logger.verbose(`MsalProvider - Registered event callback with id: ${callbackId}`);\r\n\r\n        return () => {\r\n            // Remove callback when component unmounts or accounts change\r\n            if (callbackId) {\r\n                logger.verbose(`MsalProvider - Removing event callback ${callbackId}`);\r\n                instance.removeEventCallback(callbackId);\r\n            }\r\n        };\r\n    }, [instance, accounts, logger]);\r\n\r\n    useEffect(() => {\r\n        const callbackId = instance.addEventCallback((message: EventMessage) => {\r\n            const status = EventMessageUtils.getInteractionStatusFromEvent(message, inProgressRef.current);\r\n            if (status !== null) {\r\n                logger.info(`MsalProvider - ${message.eventType} results in setting inProgress from ${inProgressRef.current} to ${status}`);\r\n                inProgressRef.current = status;\r\n                setInProgress(status);\r\n            }\r\n        });\r\n        logger.verbose(`MsalProvider - Registered event callback with id: ${callbackId}`);\r\n\r\n        instance.handleRedirectPromise().catch(() => {\r\n            // Errors should be handled by listening to the LOGIN_FAILURE event\r\n            return;\r\n        });\r\n\r\n        return () => {\r\n            if (callbackId) {\r\n                logger.verbose(`MsalProvider - Removing event callback ${callbackId}`);\r\n                instance.removeEventCallback(callbackId);\r\n            }\r\n        };\r\n    }, [instance, logger]);\r\n\r\n    const contextValue: IMsalContext = {\r\n        instance,\r\n        inProgress,\r\n        accounts,\r\n        logger\r\n    };\r\n\r\n    return (\r\n        <MsalContext.Provider value={contextValue}>\r\n            {children}\r\n        </MsalContext.Provider>\r\n    );\r\n}\r\n\r\n","/* eslint-disable header/header */\r\nexport const name = \"@azure/msal-react\";\r\nexport const version = \"1.1.0\";\r\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\nimport React, { PropsWithChildren, useMemo } from \"react\";\r\nimport { useMsal } from \"../hooks/useMsal\";\r\nimport { useIsAuthenticated } from \"../hooks/useIsAuthenticated\";\r\nimport { getChildrenOrFunction } from \"../utils/utilities\";\r\nimport { AccountIdentifiers } from \"../types/AccountIdentifiers\";\r\nimport { InteractionStatus } from \"@azure/msal-browser\";\r\n\r\nexport type UnauthenticatedTemplateProps = PropsWithChildren<AccountIdentifiers>;\r\n\r\n/**\r\n * Renders child components if user is unauthenticated\r\n * @param props \r\n */\r\nexport function UnauthenticatedTemplate({ username, homeAccountId, localAccountId, children }: UnauthenticatedTemplateProps): React.ReactElement|null {\r\n    const context = useMsal();\r\n    const accountIdentifier: AccountIdentifiers = useMemo(() => {\r\n        return {\r\n            username,\r\n            homeAccountId,\r\n            localAccountId\r\n        };\r\n    }, [username, homeAccountId, localAccountId]);\r\n    const isAuthenticated = useIsAuthenticated(accountIdentifier);\r\n\r\n    if (!isAuthenticated && context.inProgress !== InteractionStatus.Startup && context.inProgress !== InteractionStatus.HandleRedirect) {\r\n        return (\r\n            <React.Fragment>\r\n                {getChildrenOrFunction(children, context)}\r\n            </React.Fragment>\r\n        );\r\n    }\r\n    return null;\r\n}\r\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\nimport React from \"react\";\r\nimport { IMsalContext } from \"../MsalContext\";\r\nimport { useMsal } from \"../hooks/useMsal\";\r\nimport { Subtract } from \"../utils/utilities\";\r\n\r\nexport type WithMsalProps = {\r\n    msalContext: IMsalContext;\r\n};\r\n\r\n/**\r\n * Higher order component wraps provided component with msal by injecting msal context values into the component's props \r\n * @param Component \r\n */\r\nexport const withMsal = <P extends WithMsalProps>(Component: React.ComponentType<P>): React.FunctionComponent<Subtract<P,WithMsalProps>> => {\r\n    const ComponentWithMsal: React.FunctionComponent<Subtract<P,WithMsalProps>> = props => {\r\n        const msal = useMsal();\r\n        return <Component {...(props as P)} msalContext={msal} />;\r\n    };\r\n\r\n    const componentName =\r\n        Component.displayName || Component.name || \"Component\";\r\n    ComponentWithMsal.displayName = `withMsal(${componentName})`;\r\n\r\n    return ComponentWithMsal;\r\n};\r\n"],"names":["MsalContext","React","instance","stubbedPublicClientApplication","inProgress","InteractionStatus","None","accounts","logger","Logger","MsalConsumer","Consumer","getChildrenOrFunction","children","args","useMsal","useContext","getAccount","accountIdentifiers","allAccounts","getAllAccounts","length","homeAccountId","localAccountId","username","filter","accountObj","toLowerCase","useAccount","initialStateValue","Startup","account","setAccount","useState","useEffect","currentAccount","AccountEntity","accountInfoIsEqual","isAuthenticated","matchAccount","useIsAuthenticated","hasAuthenticated","setHasAuthenticated","useMsalAuthentication","interactionType","authenticationRequest","result","error","setResponse","hasBeenCalled","setHasBeenCalled","login","useCallback","async","callbackInteractionType","callbackRequest","loginRequest","InteractionType","Popup","verbose","loginPopup","Redirect","loginRedirect","then","Silent","ssoSilent","callbackId","addEventCallback","message","eventType","EventType","LOGIN_SUCCESS","SSO_SILENT_SUCCESS","payload","LOGIN_FAILURE","SSO_SILENT_FAILURE","removeEventCallback","info","catch","context","useMemo","Fragment","loadingComponent","LoadingComponent","errorComponent","ErrorComponent","accountIdentifier","msalAuthResult","initializeWrapperLibrary","WrapperSKU","getLogger","clone","setAccounts","setInProgress","inProgressRef","useRef","ACCOUNT_ADDED","ACCOUNT_REMOVED","HANDLE_REDIRECT_END","LOGOUT_END","ACQUIRE_TOKEN_SUCCESS","ACQUIRE_TOKEN_FAILURE","currentAccounts","arrayA","arrayB","comparisonArray","every","elementA","elementB","shift","accountArraysAreEqual","status","EventMessageUtils","getInteractionStatusFromEvent","current","handleRedirectPromise","Provider","value","HandleRedirect","Component","ComponentWithMsal","props","msal","msalContext","displayName","name"],"mappings":"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"}